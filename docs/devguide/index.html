
  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    

<!Doctype html>
<html id="docs" class="Developer Guide">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono">
    <link rel="stylesheet" type="text/css" href="/css/styles.css"><!-- default styles.css on -->
    <link rel="stylesheet" type="text/css" href="/css/jquery-ui.min.css">
    <link rel="stylesheet" type="text/css" href="/css/sweetalert.min.css">
    <link rel="stylesheet" type="text/css" href="/css/callouts.css">
    <link rel="stylesheet" type="text/css" href="/css/custom-jekyll/tags.css">
    <link rel="stylesheet" type="text/css" href="/css/custom-jekyll/hover-anchors.css">
    
    
    <!-- no custom css detected -->

    
    <meta name="description" content="Developer Guide" />
    

    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/jquery-ui.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/sweetalert.min.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/custom-jekyll/tags.js"></script>
    <!-- no custom js detected -->
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Developer Guide | Service Catalog - Kubernetes</title>
<meta name="generator" content="Jekyll v3.6.3" />
<meta property="og:title" content="Developer Guide" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Kubernetes SIG Service Catalog" />
<meta property="og:description" content="Kubernetes SIG Service Catalog" />
<link rel="canonical" href="https://service-catalog.drycc.cc/docs/devguide/" />
<meta property="og:url" content="https://service-catalog.drycc.cc/docs/devguide/" />
<meta property="og:site_name" content="Service Catalog - Kubernetes" />
<script type="application/ld+json">
{"url":"https://service-catalog.drycc.cc/docs/devguide/","@type":"WebPage","headline":"Developer Guide","description":"Kubernetes SIG Service Catalog","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link type="application/atom+xml" rel="alternate" href="https://service-catalog.drycc.cc/feed.xml" title="Service Catalog - Kubernetes" /> 
</head>


<body>

<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">

            <li><a href="/docs/">Documentation</a></li>
            <li><a href="https://github.com/drycc-addons/service-catalog">GitHub</a></li>
            <li><a href="/community">Community</a></li>
        </ul>
        <a href="/docs/walkthrough" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Service Catalog</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/walkthrough">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://github.com/drycc-addons/service-catalog" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Developer Guide</h1>
  <h5>How to contribute to and build the Service Catalog</h5>
  <div id="vendorStrip" class="light-text">
    <ul>
      <li><a href="/docs/" >HOME</a></li>
      <li><a href="/docs/concepts" >CONCEPTS</a></li>
      <li><a href="/docs/tasks" >TASKS</a></li>
      <li><a href="/docs/install" >INSTALL</a></li>
      <li><a href="/docs/walkthrough" >WALKTHROUGH</a></li>
      <li><a href="/docs/cli" >CLI</a></li>
    </ul>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)" autofocus="autofocus">
    </div>
  </div>
</section>




<section id="encyclopedia">
  <div id="docsToc">
        <div class="pi-accordion">
          
  

    

    
      <a class="item" data-title="Developer Guide" href="/docs/devguide/"></a>
    
  

  

    

    
      <a class="item" data-title="Overview" href="/docs/devguide/#overview"></a>
    
  

  

    

    
      <a class="item" data-title="Working on Issues" href="/docs/devguide/#working-on-issues"></a>
    
  

  

    

    
      <a class="item" data-title="Prerequisites" href="/docs/devguide/#prerequisites"></a>
    
  

  

    

    
      <a class="item" data-title="Workflow" href="/docs/devguide/#workflow"></a>
    
  

  

    

    
      <a class="item" data-title="Building" href="/docs/devguide/#building"></a>
    
  

  

    

    
      <a class="item" data-title="Testing" href="/docs/devguide/#testing"></a>
    
  

  

    

    
      <a class="item" data-title="FeatureGates" href="#featuregates"></a>
    
  

  

    

    
      <a class="item" data-title="Documentation" href="#documentation"></a>
    
  

  

    

    
      <a class="item" data-title="Making a Contribution" href="#making-a-contribution"></a>
    
  

  

    

    
      <a class="item" data-title="Advanced Build Steps" href="/docs/devguide/#advanced-build-steps"></a>
    
  

  

    

    
      <a class="item" data-title="Dependency Management" href="/docs/devguide/#dependency-management"></a>
    
  

  

    

    
      <a class="item" data-title="Deploying to Kubernetes" href="/docs/devguide/#deploying-to-kubernetes"></a>
    
  

  

    

    
      <a class="item" data-title="Demo walkthrough" href="/docs/devguide/#demo-walkthrough"></a>
    
  


        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
  </div> <!-- /docsToc -->

  <div id="docsContent">
        <p><a href="/editdocs#docs/devguide.md" id="editPageButton">Edit This Page</a></p>

        
          <h1>Developer Guide</h1>
        

        <h2 id="overview">Overview</h2>

<p>Thank you for deciding to contribute to our project! 💖 We welcome contributors
from all backgrounds and experience levels.</p>

<p>If you are interested in going beyond a single PR, take a look at our 
<a href="/docs/contribute/ladder/">contribution ladder</a> and learn how to become a reviewer, 
or even a maintainer!</p>

<h2 id="working-on-issues">Working on Issues</h2>

<p>Github does not allow non-maintainers to assign, or be assigned to, issues.
As such non-maintainers can indicate their desire to work on (own) a particular
issue by adding a comment to it of the form:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#dibs
</code></pre></div></div>

<p>However, it is a good idea to discuss the issue, and your intent to work on it,
with the other members via the <a href="https://kubernetes.slack.com/messages/sig-service-catalog">slack channel</a>
to make sure there isn’t some other work already going on with respect to that
issue.</p>

<p>When you create a pull request (PR) that completely addresses an open issue
please include a line in the initial comment that looks like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Closes: #1234
</code></pre></div></div>

<p>where <code class="highlighter-rouge">1234</code> is the issue number. This allows Github to <a href="https://help.github.com/articles/closing-issues-using-keywords/">automatically
close the issue</a>
when the PR is merged.</p>

<p>Also, before you start working on your issue, please read our <a href="/docs/code-standards/">Code Standards</a>
document.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>At a minimum you will need:</p>

<ul>
  <li><a href="https://www.docker.com">Docker</a> 17.05+ installed locally (configured with 4+ GB RAM)</li>
  <li>GNU Make</li>
  <li><a href="https://git-scm.com">git</a></li>
</ul>

<p>These will allow you to build and test service catalog components within a
Docker container.</p>

<p>If you want to deploy service catalog components built from source, you will
also need:</p>

<ul>
  <li>A working Kubernetes cluster and <code class="highlighter-rouge">kubectl</code> installed in your local <code class="highlighter-rouge">PATH</code>,
properly configured to access that cluster. The version of Kubernetes and
<code class="highlighter-rouge">kubectl</code> must be &gt;= 1.12. See below for instructions on how to download these
versions of <code class="highlighter-rouge">kubectl</code></li>
  <li><a href="https://helm.sh">Helm</a> (Tiller) installed in your Kubernetes cluster and the
<code class="highlighter-rouge">helm</code> binary in your <code class="highlighter-rouge">PATH</code></li>
  <li>To be pre-authenticated to a Docker registry (if using a remote cluster)</li>
</ul>

<p><strong>Note:</strong> It is not generally useful to run service catalog components outside
a Kubernetes cluster. As such, our build process only supports compilation of
linux/amd64 binaries suitable for execution within a Docker container.</p>

<h2 id="workflow">Workflow</h2>
<p>We can set up the repo by following a process similar to the <a href="https://github.com/kubernetes/community/blob/master/contributors/devel/development.md#1-fork-in-the-cloud">dev guide for k8s</a></p>

<h3 id="1-fork-in-the-cloud">1 Fork in the Cloud</h3>
<ol>
  <li>Visit https://github.com/drycc-addons/service-catalog</li>
  <li>Click Fork button (top right) to establish a cloud-based fork.</li>
</ol>

<h3 id="2-clone-fork-to-local-storage">2 Clone fork to local storage</h3>

<p>From your shell:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># Set user to match your github profile name</span>
<span class="nv">user</span><span class="o">={</span>your github profile name<span class="o">}</span>

<span class="c"># Create your clone:</span>
mkdir <span class="nt">-p</span> <span class="nv">$working_dir</span>
<span class="nb">cd</span> <span class="nv">$working_dir</span>
git clone https://github.com/<span class="nv">$user</span>/service-catalog.git
<span class="c"># or: git clone git@github.com:$user/service-catalog.git</span>

<span class="nb">cd </span>service-catalog
git remote add upstream https://github.com/drycc-addons/service-catalog.git
<span class="c"># or: git remote add upstream git@github.com:kubernetes-sigs/service-catalog.git</span>

<span class="c"># Never push to upstream master</span>
git remote set-url <span class="nt">--push</span> upstream no_push

<span class="c"># Confirm that your remotes make sense:</span>
git remote <span class="nt">-v</span>
</code></pre></div></div>

<h2 id="code-layout">Code Layout</h2>
<p>This repository is organized as similarly to Kubernetes itself as the developers
have found possible (or practical). Below is a summary of the repository’s
layout:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.
├── bin                     # Destination for binaries compiled for linux/amd64 (untracked)
├── build                   # Contains build-related scripts and subdirectories containing Dockerfiles
├── charts                  # Helm charts for deployment
│   ├── catalog             # Helm chart for deploying the service catalog
│   └── ups-broker          # Helm chart for deploying the user-provided service broker
├── cmd                     # Contains "main" Go packages for each service catalog component binary
│   ├── controller-manager  # The service catalog controller manager service-catalog command
│   ├── service-catalog     # The service catalog binary, which is used to run commands
│   ├── svcat               # The command-line interface for interacting with kubernetes service-catalog resources
│   └── webhook             # The service catalog webhook server command
├── contrib                 # Contains examples, non-essential golang source, CI configurations, etc
│   ├── build               # Dockerfiles for contrib images (example: ups-broker)
│   ├── cmd                 # Entrypoints for contrib binaries
│   ├── examples            # Example API resources
│   ├── hack                # Non-build related scripts
│   │   ├── ci              # CI configuration
│   │   └── ...             # Rest helper bash scripts
│   └── pkg                 # Contrib golang code
├── docs                    # Documentation
├── pkg                     # Contains all non-"main" Go packages
├── plugin                  # Plugins for API server
├── test                    # Integration and e2e tests
├── vendor                  # dep-managed dependencies
├── go.mod                  # defines projects requirements and locks dependencies
└── go.sum                  # the expected cryptographic checksums of go.mod dependencies
</code></pre></div></div>

<h2 id="building">Building</h2>

<p>First <code class="highlighter-rouge">cd</code> to the root of the cloned repository tree.
To build the service-catalog server components:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make build
</code></pre></div></div>

<p>The above will build all executables and place them in the <code class="highlighter-rouge">bin</code> directory. This
is done within a Docker container– meaning you do not need to have all of the
necessary tooling installed on your host (such as a golang compiler or dep).
Building outside the container is possible, but not officially supported.</p>

<p>To build the service-catalog client, <code class="highlighter-rouge">svcat</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make svcat
</code></pre></div></div>

<p>The svcat cli binary is located at <code class="highlighter-rouge">bin/svcat/svcat</code>.</p>

<p>To install <code class="highlighter-rouge">svcat</code> to your $GOPATH/bin directory:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make svcat-install
</code></pre></div></div>

<p>Note, this will do the basic build of the service catalog. There are more
more <a href="#advanced-build-steps">advanced build steps</a> below as well.</p>

<p>To deploy to Kubernetes, see the
<a href="#deploying-to-kubernetes">Deploying to Kubernetes</a> section.</p>

<h3 id="notes-concerning-the-build-processmakefile">Notes Concerning the Build Process/Makefile</h3>

<ul>
  <li>The Makefile assumes you’re running <code class="highlighter-rouge">make</code> from the root of the repo.</li>
  <li>
    <p>There are some source files that are generated during the build process.
These are:</p>

    <ul>
      <li><code class="highlighter-rouge">pkg/client/*_generated</code></li>
      <li><code class="highlighter-rouge">pkg/apis/servicecatalog/zz_*</code></li>
      <li><code class="highlighter-rouge">pkg/apis/servicecatalog/v1beta1/zz_*</code></li>
      <li><code class="highlighter-rouge">pkg/apis/servicecatalog/v1beta1/types.generated.go</code></li>
      <li><code class="highlighter-rouge">pkg/openapi/openapi_generated.go</code></li>
    </ul>
  </li>
  <li>Running <code class="highlighter-rouge">make clean</code> or <code class="highlighter-rouge">make clean-generated</code> will roll back (via
<code class="highlighter-rouge">git checkout --</code>) the state of any generated files in the repo.</li>
  <li>Running <code class="highlighter-rouge">make purge-generated</code> will <em>remove</em> those generated files from the
repo.</li>
  <li>A Docker Image called “scbuildimage” will be used. The image isn’t pre-built
and pulled from a public registry. Instead, it is built from source contained
within the service catalog repository.</li>
  <li>While many people have utilities, such as editor hooks, that auto-format
their go source files with <code class="highlighter-rouge">gofmt</code>, there is a Makefile target called
<code class="highlighter-rouge">format</code> which can be used to do this task for you.</li>
  <li><code class="highlighter-rouge">make build</code> will build binaries for linux/amd64 only.</li>
</ul>

<h2 id="testing">Testing</h2>

<p>There are three types of tests: unit, integration and e2e.</p>

<h3 id="unit-tests">Unit Tests</h3>

<p>The unit testcases can be run via the <code class="highlighter-rouge">test-unit</code> Makefile target, e.g.:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make test-unit
</code></pre></div></div>

<p>These will execute any <code class="highlighter-rouge">*_test.go</code> files within the source tree.</p>

<h3 id="integration-tests">Integration Tests</h3>

<p>The integration tests can be run via the <code class="highlighter-rouge">test-integration</code> Makefile target,
e.g.:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make test-integration
</code></pre></div></div>

<p>The integration tests require the Kubernetes client (<code class="highlighter-rouge">kubectl</code>) so there is a
script called <code class="highlighter-rouge">contrib/hack/kubectl</code> that will run it from within a
Docker container. This avoids the need for you to download, or install it,
youself. You may find it useful to add <code class="highlighter-rouge">contrib/hack</code> to your <code class="highlighter-rouge">PATH</code>.</p>

<h3 id="e2e-tests">E2E Tests</h3>

<p>The e2e tests are executed against Kubernetes cluster with service-catalog deployed 
into it. The e2e testcases can be run via the <code class="highlighter-rouge">test-e2e</code> Makefile target:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp"> $</span> make test-e2e
</code></pre></div></div>

<p>Sample test output:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">I0816 17:20:37.451423   75760 e2e.go:45] Starting e2e run "e39cfcd2-cbae-41fc-96ee-447095a492bd" on Ginkgo node 1
Running Suite: Service Catalog e2e suite
========================================
Random Seed: 1565968837 - Will randomize all specs
Will run 5 of 5 specs

</span><span class="gp">&lt; ... Test Output ... &gt;</span>
<span class="go">
•
Ran 5 of 5 Specs in 49.761 seconds
SUCCESS! -- 5 Passed | 0 Failed | 0 Pending | 0 Skipped --- PASS: TestE2E (49.76s)
</span></code></pre></div></div>

<blockquote>
  <p><strong>NOTE:</strong> Docker is required for running e2e tests locally.</p>
</blockquote>

<p>Under the hood, the script executes such flow:</p>

<ol>
  <li>Install <a href="https://github.com/helm/helm">Helm</a> and the <a href="https://github.com/kubernetes-sigs/kind">kind</a> tool.</li>
  <li>Provision a Kubernetes cluster using the kind tool.</li>
  <li>Build Service Catalog images from sources.</li>
  <li>Deploy Service Catalog into cluster.</li>
  <li>
    <p>Execute <a href="../test/e2e">e2e tests</a>.</p>

    <p>If any test fails, then <a href="https://github.com/kubernetes/kubernetes/blob/release-1.14/pkg/kubectl/cmd/clusterinfo/clusterinfo_dump.go#L93-L96">cluster info</a> from the namespace where the Service Catalog is installed is dumped.</p>
  </li>
  <li>Delete the Kubernetes cluster.</li>
</ol>

<h3 id="test-running-tips">Test Running Tips</h3>

<p>The <code class="highlighter-rouge">test</code> Makefile target will run both the unit and integration tests, e.g.:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make test
</code></pre></div></div>

<p>If you want to run just a subset of the unit testcases then you can
specify the source directories of the tests:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ TEST_DIRS="path1 path2" make test
</code></pre></div></div>

<p>or you can specify a regexp expression for the test name:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ UNIT_TESTS=TestBar* make test
</code></pre></div></div>

<p>a regexp expression also works for integration test names:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ INT_TESTS=TestIntegrateBar* make test
</code></pre></div></div>

<p>You can also set the log level for the tests, which is useful for
debugging using the <code class="highlighter-rouge">TEST_LOG_LEVEL</code> env variable. Log level 5 e.g.:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ TEST_LOG_LEVEL=5 make test-integration
</code></pre></div></div>

<h3 id="test-code-coverage">Test Code Coverage</h3>

<p>To see how well these tests cover the source code, you can use:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make coverage
</code></pre></div></div>

<p>These will execute the tests and perform an analysis of how well they
cover all code paths. The results are put into a file called:
<code class="highlighter-rouge">coverage.html</code> at the root of the repo.</p>

<p>As mentioned above, integration tests require a running Catalog API &amp; ETCD image
and a properly configured .kubeconfig.  When developing or drilling in on a
specific test failure you may find it helpful to run Catalog in your “normal”
environment and as long as you have properly configured your KUBECONFIG
environment variable you can run integration tests much more quickly with a
couple of commands:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make build-integration
$ ./integration.test -test.v -v 5 -logtostderr -test.run  TestPollServiceInstanceLastOperationSuccess/async_provisioning_with_error_on_second_poll
</code></pre></div></div>

<p>The first command ensures the test integration executable is up-to-date.  The
second command runs one specific test case with verbose logging and can be
re-run over and over without having to wait for the start and stop of API and
ETCD.  This example will execute the test case “async provisioning with error on
second poll” within the integration test
TestPollServiceInstanceLastOperationSuccess.</p>

<h3 id="golden-files">Golden Files</h3>
<p>The svcat tests rely on “<a href="https://medium.com/@povilasve/go-advanced-tips-tricks-a872503ac859#a196">golden files</a>”,
a pattern used in the Go standard library, for testing command output. The expected
output is stored in a file in the testdata directory, <code class="highlighter-rouge">cmd/svcat/testdata</code>, and
and then the test’s output is compared against the “golden output” stored
in that file. It helps avoid putting hard coded strings in the tests themselves.</p>

<p>You do not edit the golden files by hand. When you need to update the golden
files, run <code class="highlighter-rouge">make test-update-goldenfiles</code> or <code class="highlighter-rouge">go test ./cmd/svcat/... -update</code>,
and the golden files are updated automatically with the results of the test run.</p>

<p>For new tests, first you need to manually create the empty golden file into the destination
directory specified in your test, e.g. <code class="highlighter-rouge">touch cmd/svcat/testdata/mygoldenfile.txt</code>
before updating the golden files. This only manages the contents of the golden files,
but doesn’t create or delete them.</p>

<p>Keep in mind that golden files help catch errors when the output unexpectedly changes.
It’s up to you to judge when you should run the tests with -update,
and to diff the changes in the golden file to ensure that the new output is correct.</p>

<h3 id="counterfeiter">Counterfeiter</h3>
<p>Certain tests use fakes generated with <a href="http://github.com/maxbrunsfeld/counterfeiter">Counterfeiter</a>. If you add a method
to an interface (such as SvcatClient in pkg/svcat/service-catalog) you may need to regenerate the fake. You can install
Counterfeiter by running <code class="highlighter-rouge">go get github.com/maxbrunsfeld/counterfeiter</code>.
Then regenerate the fake with <code class="highlighter-rouge">counterfeiter ./pkg/svcat/service-catalog SvcatClient</code> and manually paste the boilerplate
copyright comment into the generated file.</p>

<h2 id="featuregates">FeatureGates</h2>
<p>Feature gates are a set of key=value pairs that describe experimental features
and can be turned on or off by specifying the value when launching the Service
Catalog executable (typically done in the Helm chart).  A new feature gate
should be created when introducing new features that may break existing
functionality or introduce instability.  See <a href="/docs/feature-gates/">FeatureGates</a>
for more details.</p>

<p>When adding a FeatureGate to Helm charts, define the variable
<code class="highlighter-rouge">fooEnabled</code> with the <code class="highlighter-rouge">false</code> value in <a href="https://github.com/drycc-addons/service-catalog/blob/master/charts/catalog/values.yaml">values.yaml</a>.<br />
In the <a href="https://github.com/drycc-addons/service-catalog/blob/master/charts/catalog/templates/webhook-deployment.yaml">Webhook Server</a> and <a href="https://github.com/drycc-addons/service-catalog/blob/master/charts/catalog/templates/controller-manager-deployment.yaml">Controller</a>
templates, add the new FeatureGate:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="pi">-</span> <span class="s">--feature-gates</span>
    <span class="pi">-</span> <span class="s">Foo={{.Values.fooEnabled}}</span>
</code></pre></div></div>

<p>When the feature has had enough testing and the community agrees to change the
default to true, update <a href="https://github.com/drycc-addons/service-catalog/blob/master/pkg/features/features.go">features.go</a> and <code class="highlighter-rouge">values.yaml</code> changing the default for
feature foo to <code class="highlighter-rouge">true</code>. And lastly update the appropriate information in the
<a href="/docs/feature-gates/">FeatureGates doc</a>.</p>

<h2 id="documentation">Documentation</h2>

<p>Our documentation site is located at <a href="https://service-catalog.drycc.cc">service-catalog.drycc.cc</a>. The content files are located
in the <code class="highlighter-rouge">docs/</code> directory, and the website framework in <code class="highlighter-rouge">docsite/</code>.</p>

<p>To preview your changes, run <code class="highlighter-rouge">make docs-preview</code> and then open <code class="highlighter-rouge">http://localhost:4000</code> in
your web browser. When you create a pull request, you can preview documentation changes by
clicking on the <code class="highlighter-rouge">deploy/netlify</code> build check in your PR.</p>

<h2 id="making-a-contribution">Making a Contribution</h2>

<p>Once you have compiled and tested your code locally, make a Pull
Request. Create a branch on your local repo with a short descriptive
name of the work you are doing. Make a commit with the work in it, and
push it up to your remote fork on github. Come back to the code tab of
the repository, and there should be a box suggesting to make a Pull
Request.</p>

<p>Pull requests are expected to have a few things before asking people to review the PR:</p>

<ul>
  <li><a href="#building">Build the code</a> with <code class="highlighter-rouge">make build</code> (for server-side changes) or <code class="highlighter-rouge">make svcat</code> (for cli changes).</li>
  <li><a href="#testing">Run the tests</a> with <code class="highlighter-rouge">make test</code>.</li>
  <li>Run the build checks with <code class="highlighter-rouge">make verify</code>. This helps catch compilation errors
and code formatting/linting problems.</li>
  <li>Added new tests or updated existing tests to verify your changes. If this is a svcat related change,
you may need to <a href="#golden-files">update the golden files</a>.</li>
  <li>Any associated documentation changes. You can preview documentation changes by
clicking on the <code class="highlighter-rouge">deploy/netlify</code> build check on your pull request.</li>
</ul>

<p>After you create a PR, relevant CI tests need to complete successfully.
If you are not a Kubernetes, contact the repository maintainers specified in the CODEOWNERS file to review 
your PR and add the <a href="https://prow.k8s.io/command-help#ok_to_test">ok-to-test</a> label to your PR to trigger all tests.</p>

<p>If a test fails, check the reason by clicking the Details button next to the given job on your PR. 
Make the required changes and the tests rerun. If you want to run a specific test, 
add the /test {test-name} or /retest {test-name} comment to your PR. To rerun all failed tests, add the /retest comment.</p>

<p>You can use the <a href="https://prow.k8s.io/command-help#cc">Prow /cc command</a>
to request reviews from the maintainers of the project. This works even
if you do not have status in the service-catalog project.</p>

<h2 id="advanced-build-steps">Advanced Build Steps</h2>

<p>You can build the service catalog executables into Docker images yourself. By
default, image names are <code class="highlighter-rouge">quay.io/kubernetes-service-catalog/&lt;component&gt;</code>. Since
most contributors who hack on service catalog components will wish to produce
custom-built images, but will be unable to push to this location, it can be
overridden through use of the <code class="highlighter-rouge">REGISTRY</code> environment variable.</p>

<p>Examples of service-catalog image names:</p>

<table>
  <thead>
    <tr>
      <th><code class="highlighter-rouge">REGISTRY</code></th>
      <th>Fully Qualified Image Name</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Unset; default</td>
      <td><code class="highlighter-rouge">quay.io/kubernetes-service-catalog/service-catalog</code></td>
      <td>You probably don’t have permissions to push to here</td>
    </tr>
    <tr>
      <td>Dockerhub username + trailing slash, e.g. <code class="highlighter-rouge">krancour/</code></td>
      <td><code class="highlighter-rouge">krancour/service-catalog</code></td>
      <td>Missing hostname == Dockerhub</td>
    </tr>
    <tr>
      <td>Dockerhub username + slash + some prefix, e.g. <code class="highlighter-rouge">krancour/sc-</code></td>
      <td><code class="highlighter-rouge">krancour/sc-service-catalog</code></td>
      <td>The prefix is useful for disambiguating similarly names images within a single namespace.</td>
    </tr>
    <tr>
      <td>192.168.99.102:5000/</td>
      <td><code class="highlighter-rouge">192.168.99.102:5000/service-catalog</code></td>
      <td>A local registry</td>
    </tr>
  </tbody>
</table>

<p>With <code class="highlighter-rouge">REGISTRY</code> set appropriately:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make images push
</code></pre></div></div>

<p>This will build Docker images for all service catalog components. The images are
also pushed to the registry specified by the <code class="highlighter-rouge">REGISTRY</code> environment variable, so
they can be accessed by your Kubernetes cluster.</p>

<p>The images are tagged with the current Git commit SHA:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker images
</code></pre></div></div>

<h3 id="svcat-targets">svcat targets</h3>
<p>These are targets for the service-catalog client, <code class="highlighter-rouge">svcat</code>:</p>

<ul>
  <li><code class="highlighter-rouge">make svcat-all</code> builds all supported client platforms (darwin, linux, windows).</li>
  <li><code class="highlighter-rouge">make svcat-for-X</code> builds a specific platform.</li>
  <li><code class="highlighter-rouge">make svcat</code> builds for the current dev’s platform.</li>
  <li><code class="highlighter-rouge">make svcat-publish</code> compiles everything and uploads the binaries.</li>
</ul>

<p>The same tags are used for both client and server. The cli uses the format that
always includes a tag, so that it’s clear which release you are “closest” to,
e.g. v1.2.3 for official releases and v1.2.3-2-gabc123 for untagged commits.</p>

<h3 id="deploying-releases">Deploying Releases</h3>

<ul>
  <li>Merge to master - A docker image for the server is pushed to <a href="http://quay.io/kubernetes-service-catalog/service-catalog">quay.io/kubernetes-service-catalog/service-catalog</a>,
tagged with the abbreviated commit hash. Nothing is deployed for the client, <code class="highlighter-rouge">svcat</code>.</li>
  <li>Tag a commit on master with vX.Y.Z - A docker image for the server is pushed,
tagged with the version, e.g. vX.Y.Z. The client binaries are published to
https://download.svcat.sh/cli/latest/OS/ARCH/svcat and https://download.svcat.sh/cli/VERSION/OS/ARCH/svcat.</li>
</ul>

<p>The idea behind “latest” link is that we can provide a permanent link to the most recent stable release of <code class="highlighter-rouge">svcat</code>.
If someone wants to install a unreleased version, they must build it locally.</p>

<hr />

<h2 id="deploying-to-kubernetes">Deploying to Kubernetes</h2>

<p>Use the <a href="../charts/catalog"><code class="highlighter-rouge">catalog</code> chart</a> to deploy the service
catalog into your cluster.  The easiest way to get started is to deploy into a
cluster you regularly use and are familiar with.</p>

<p>If you have recently merged changes that haven’t yet made it into a
release, you probably want to deploy the canary images. Always use the
canary images when testing local changes.</p>

<p>For more information see the
<a href="/docs/install/">installation instructions</a>. The last two lines of
the following <code class="highlighter-rouge">helm install</code> example show the canary images being
installed with the other standard installation options.</p>

<p>From the root of this repository:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm install charts/catalog \
    --name catalog --namespace catalog \
    --set image=quay.io/kubernetes-service-catalog/service-catalog:canary
</code></pre></div></div>

<h3 id="deploy-local-canary">Deploy local canary</h3>
<p>For your convenience, you can use the following script quickly rebuild, push and
deploy the canary image. There are a few assumptions about your environment and
configuration in the script. If the assumptions do
not match your needs, we suggest copying the contents of that script and using
it as a starting off point for your own custom deployment script.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">#</span> The registry defaults to DockerHub with the same user name as the current user
<span class="gp">#</span> Examples: quay.io/myuser/service-catalog/, another-user/
<span class="gp">$</span> <span class="nb">export </span><span class="nv">REGISTRY</span><span class="o">=</span><span class="s2">"myuser/"</span>
<span class="gp">$</span> ./contrib/hack/deploy-local-canary.sh
</code></pre></div></div>

<h2 id="dependency-management">Dependency Management</h2>

<p>This section is intended to show a way for managing <code class="highlighter-rouge">vendor/</code> tree dependencies using go modules.</p>

<h3 id="theory-of-operation">Theory of operation</h3>

<p>The <code class="highlighter-rouge">go.mod</code> file describes dependencies using two directives:</p>

<ul>
  <li><code class="highlighter-rouge">require</code> directives list the preferred version of dependencies (this is auto-updated by go tooling to the maximum preferred version of the module)</li>
  <li><code class="highlighter-rouge">replace</code> directives pin to specific tags or commits</li>
</ul>

<h3 id="adding-or-updating-a-dependency">Adding or updating a dependency</h3>

<p>The most common things people need to do with dependencies are adding and updating them.
These operations are handled the same way:</p>

<p>For the sake of examples, consider that we have discovered a wonderful Go
library at <code class="highlighter-rouge">example.com/go/foo</code>.</p>

<p>Step 1: Ensure there is go code in place that references the packages you want to use.</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span><span class="x"> </span><span class="s">"example.com/go/foo"</span><span class="x">
</span><span class="c">// ...</span><span class="x">
</span><span class="n">frob</span><span class="o">.</span><span class="n">DoStuff</span><span class="p">()</span><span class="x">
</span></code></pre></div></div>

<p>Step 2: Determine what version of the dependency you want to use, and add that version to the go.mod file:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>contrib/hack/pin-dependency.sh example.com/go/foo v1.0.4
</code></pre></div></div>

<p>This fetches the dependency, resolves the specified sha or tag, and adds two entries to the <code class="highlighter-rouge">go.mod</code> file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require (
    example.com/go/foo v1.0.4
    ...
)

replace (
    example.com/go/foo =&gt; example.com/go/foo v1.0.4
    ...
)
</code></pre></div></div>

<p>The <code class="highlighter-rouge">require</code> directive indicates our module requires <code class="highlighter-rouge">example.com/go/foo</code> &gt;= <code class="highlighter-rouge">v1.0.4</code>.
If our module was included as a dependency in a build with other modules that also required <code class="highlighter-rouge">example.com/go/foo</code>,
the maximum required version would be selected (unless the main module in that build pinned to a lower version).</p>

<p>The <code class="highlighter-rouge">replace</code> directive pins us to the desired version when running go commands e.g. build svcat binary.</p>

<p>Step 3: Rebuild the <code class="highlighter-rouge">vendor</code> directory:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>contrib/hack/update-vendor.sh
</code></pre></div></div>

<p>Step 4: Check if the new dependency was added correctly:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>contrib/hack/lint-dependencies.sh
</code></pre></div></div>

<h3 id="removing-a-dependency">Removing a dependency</h3>

<p>This happens almost for free.  If you edit Service Catalog code and remove the last
use of a given dependency, you only need to run <code class="highlighter-rouge">contrib/hack/update-vendor.sh</code>, and the
tooling will figure out that you don’t need that dependency anymore and remove it,
along with any unused transitive dependencies.</p>

<h3 id="reviewing-and-approving-dependency-changes">Reviewing and approving dependency changes</h3>

<p>Particular attention to detail should be exercised when reviewing and approving
PRs that add/remove/update dependencies. Importing a new dependency should bring
a certain degree of value as there is a maintenance overhead for maintaining
dependencies into the future.</p>

<p>When importing a new dependency, be sure to keep an eye out for the following:</p>
<ul>
  <li>Is the dependency maintained?</li>
  <li>Does the dependency bring value to the project? Could this be done without adding a new dependency?</li>
  <li>Is the target dependency the original source, or a fork?</li>
  <li>Is there already a dependency in the project that does something similar?</li>
</ul>

<blockquote>
  <p><strong>NOTE:</strong> Always check if there is a tagged release we can vendor instead of a random hash</p>
</blockquote>

<h2 id="demo-walkthrough">Demo walkthrough</h2>

<p>Check out the <a href="/docs/walkthrough/">walkthrough</a> to get started with
installation and a self-guided demo.</p>


        
           <a href="" onclick="window.open('https://github.com/drycc-addons/service-catalog/issues/new?title=Issue%20with%20' +
           'service-catalog.drycc.cc'+window.location.pathname)" class="button issue">Create an Issue</a>
        
        
          <a href="/editdocs#docs/devguide.md" class="button issue">Edit this Page</a>
        
    </div>
</section>

<footer col="12">
    <main class="light-text">
        <nav>
            <a href="/docs/walkthrough">Get Started</a>
            <a href="/docs/">Documentation</a>
            <a href="/community">Community</a>
        </nav>
        <div class="social">
            <div>
                <a href="https://github.com/drycc-addons/service-catalog" class="github"><span>Github</span></a>
                <a href="https://kubernetes.slack.com/messages/sig-service-catalog" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-sig-service-catalog" class="mailing-list"><span>Mailing List</span></a>
            </div>
            <div>
                <a href="/docs/install" class="button">Get Service Catalog</a>
                <a href="/docs/devguide" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href="/LICENSE" class="light-text">CC BY 4.0</a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2023 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
.cse .gsc-control-cse, .gsc-control-cse, {
    padding: 0;
}
  .gsc-control-cse table, .gsc-control-cse-en table {
      margin:0px !important;
  }
  .gsc-above-wrapper-area {
      border-bottom: 0;
  }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');

// hide docs nav area if no nav is present, or if nav only contains a link to the current page
/*(function () {
    window.addEventListener('DOMContentLoaded', init)

        // play nice with our neighbors
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                // container is built dynamically, so it may not be present on the first runloop
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();*/
</script>

        <script>

            $(function () {
                'use strict';

                /* selector */
                var postHeader = 'h1,h2,h3,h4';

                $(postHeader).filter('[id]').each(function () {
                    var header      = $(this),
                            headerID    = header.attr('id'),
                            anchorClass = 'header-link',
                            anchorIcon  = '<i class="octicon octicon-link" aria-hidden="true"></i>';

                    if (headerID) {
                        header.prepend($('<a />').addClass(anchorClass).attr({ 'href': '#' + headerID, 'aria-hidden': 'true' }).html(anchorIcon));
                    }

                    return this;
                });
            });


        </script>
<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
    <!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->


</body>
</html>
