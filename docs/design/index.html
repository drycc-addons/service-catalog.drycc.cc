
  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  


<!Doctype html>
<html id="docs" class="Documentation">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono">
    <link rel="stylesheet" type="text/css" href="/css/styles.css"><!-- default styles.css on -->
    <link rel="stylesheet" type="text/css" href="/css/jquery-ui.min.css">
    <link rel="stylesheet" type="text/css" href="/css/sweetalert.min.css">
    <link rel="stylesheet" type="text/css" href="/css/callouts.css">
    <link rel="stylesheet" type="text/css" href="/css/custom-jekyll/tags.css">
    <link rel="stylesheet" type="text/css" href="/css/custom-jekyll/hover-anchors.css">
    
    
    <!-- no custom css detected -->

    
    <meta name="description" content="Design of the Service Catalog" />
    

    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/jquery-ui.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/sweetalert.min.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/custom-jekyll/tags.js"></script>
    <!-- no custom js detected -->
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Design of the Service Catalog | Service Catalog - Kubernetes</title>
<meta name="generator" content="Jekyll v3.6.3" />
<meta property="og:title" content="Design of the Service Catalog" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Kubernetes SIG Service Catalog" />
<meta property="og:description" content="Kubernetes SIG Service Catalog" />
<link rel="canonical" href="https://service-catalog.drycc.cc/docs/design/" />
<meta property="og:url" content="https://service-catalog.drycc.cc/docs/design/" />
<meta property="og:site_name" content="Service Catalog - Kubernetes" />
<script type="application/ld+json">
{"url":"https://service-catalog.drycc.cc/docs/design/","@type":"WebPage","headline":"Design of the Service Catalog","description":"Kubernetes SIG Service Catalog","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link type="application/atom+xml" rel="alternate" href="https://service-catalog.drycc.cc/feed.xml" title="Service Catalog - Kubernetes" /> 
</head>


<body>

<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">

            <li><a href="/docs/">Documentation</a></li>
            <li><a href="https://github.com/drycc-addons/service-catalog">GitHub</a></li>
            <li><a href="/community">Community</a></li>
        </ul>
        <a href="/docs/walkthrough" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Service Catalog</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/walkthrough">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://github.com/drycc-addons/service-catalog" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Documentation</h1>
  <h5>Documentation for using and learning about Service Catalog.</h5>
  <div id="vendorStrip" class="light-text">
    <ul>
      <li><a href="/docs/" >HOME</a></li>
      <li><a href="/docs/concepts" >CONCEPTS</a></li>
      <li><a href="/docs/tasks" >TASKS</a></li>
      <li><a href="/docs/install" >INSTALL</a></li>
      <li><a href="/docs/walkthrough" >WALKTHROUGH</a></li>
      <li><a href="/docs/cli" >CLI</a></li>
    </ul>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)" autofocus="autofocus">
    </div>
  </div>
</section>




<section id="encyclopedia">
  <div id="docsToc">
        <div class="pi-accordion">
          
  

    

    
      <a class="item" data-title="Documentation" href="/docs/"></a>
    
  


        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
  </div> <!-- /docsToc -->

  <div id="docsContent">
        <p><a href="/editdocs#docs/design.md" id="editPageButton">Edit This Page</a></p>

        
          <h1>Design of the Service Catalog</h1>
        

        <p>This document covers the architecture and design of Service Catalog.</p>

<h4 id="table-of-contents">Table of Contents</h4>

<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#terminology">Terminology</a></li>
  <li><a href="#open-service-broker-api">Open Service Broker API</a></li>
  <li><a href="#service-catalog-design">Service Catalog Design</a>
    <ul>
      <li><a href="#webhook-server">Webhook Server</a></li>
      <li><a href="#controller">Controller</a></li>
    </ul>
  </li>
</ul>

<h2 id="overview">Overview</h2>

<p>The Service Catalog integrates with the 
<a href="https://github.com/openservicebrokerapi">Open Service Broker API</a> (OSB API) to
translate the Kubernetes resource model into OSB API calls to a service broker.</p>

<p>It has the following high level features:</p>

<ul>
  <li>Service Catalog users can register service brokers with Kubernetes</li>
  <li>Service Catalog can fetch the services and plans (called the catalog) from 
each service broker, and make it available to Kubernetes users</li>
  <li>Kubernetes users can request a new service from a broker by submitting a
<code class="highlighter-rouge">ServiceInstance</code> resource to Service Catalog</li>
  <li>Kubernetes users can link an application (i.e. one or more <code class="highlighter-rouge">Pod</code>s) to a 
service by creating a new <code class="highlighter-rouge">ServiceBinding</code> resource</li>
</ul>

<p>These features provide a loose-coupling between Applications running in 
Kubernetes and services that they use.</p>

<p>Generally, the services that applications use are external (i.e. “black box”)
to the Kubernetes cluster. For example, applications may decide to use a
cloud database service.</p>

<p>Using Service Catalog and the appropriate service broker, application
developers can focus on their own business logic, leave development and
management of the service to someone else, and leave provisioning to the 
Service Catalog and broker.</p>

<h2 id="terminology">Terminology</h2>

<ul>
  <li><strong>Application</strong>: Kubernetes uses the term “service” in a different way
than Service Catalog does, so to avoid confusion the term <em>Application</em>
will refer to the Kubernetes deployment artifact that will use a 
<code class="highlighter-rouge">ServiceInstance</code>.</li>
  <li><strong>ClusterServiceBroker</strong>: a Kubernetes resource that Service Catalog recognizes.
This resource tells Service Catalog to fetch the catalog of a new broker,
and merge the new catalog into the existing <code class="highlighter-rouge">ClusterServiceClass</code>es and 
<code class="highlighter-rouge">ClusterServicePlan</code>s (see below). This resource is global - it doesn’t have 
a namespace.</li>
  <li><strong>ClusterServiceClass</strong>: a Kubernetes resource that Service Catalog generates. After
a user submits a <code class="highlighter-rouge">ClusterServiceBroker</code>, Service Catalog fetches the broker’s 
catalog and merges the new catalog entries into <code class="highlighter-rouge">ClusterServiceClass</code>es in 
Kubernetes. Each <code class="highlighter-rouge">ClusterServiceClass</code> has one or more <code class="highlighter-rouge">ClusterServicePlan</code>s (see below).
This resource is global - it doesn’t have a namespace.</li>
  <li><strong>ClusterServicePlan</strong>: a Kubernetes resource that Service Catalog generates. After
a user submits a <code class="highlighter-rouge">ClusterServiceBroker</code>, Service Catalog fetches the broker’s
catalog and merges the new catalog entries into <code class="highlighter-rouge">ClusterServiceClass</code>es and 
<code class="highlighter-rouge">ClusterServicePlan</code>s. Plans indicate variations on each <code class="highlighter-rouge">ClusterServiceClass</code> like
cost, capacity, or quality of services (QoS).
This resource is global - it doesn’t have a namespace.</li>
  <li><strong>ServiceInstance</strong>: a Kubernetes resource that Service Catalog recognizes.
A Kubernetes user may submit a <code class="highlighter-rouge">ServiceInstance</code> to provision a new instance of a 
service. The details of the service and the plan are listed in the resource, and 
ServiceCatalog passes that information to the broker that can provision
the service. This resource is not global - it has a namespace.</li>
  <li><strong>ServiceBinding</strong>: a Kubernetes resource that Service Catalog recognizes.
A Kubernetes user may submit a <code class="highlighter-rouge">ServiceBinding</code> to indicate their intent
for their application to reference and use a <code class="highlighter-rouge">ServiceInstance</code>. Generally,
a <code class="highlighter-rouge">ServiceBinding</code> will get credentials and a hostname that the application
can use to talk to the service. After Service Catalog gets these credentials,
it writes them into a Kubernetes <code class="highlighter-rouge">Secret</code>.</li>
  <li><strong>Credentials</strong>: after Service Catalog receives the binding response, it 
writes the response data into a Kubernetes <code class="highlighter-rouge">Secret</code>. This is the information
needed for an application to talk to the service itself, and we call 
it “Credentials.”</li>
</ul>

<h2 id="open-service-broker-api">Open Service Broker API</h2>

<p>The Service Catalog is an 
<a href="https://github.com/openservicebrokerapi/servicebroker/blob/master/spec.md">Open Service Broker API</a> 
(OSB API) client. The OSB API specification is the evolution of
the <a href="https://docs.cloudfoundry.org/services/api.html">Cloud Foundry Service Broker API</a>.</p>

<p>We’re not going to detail the OSB API here; for more information, please see
the 
<a href="https://github.com/openservicebrokerapi/servicebroker">Open Service Broker API Repository</a>.</p>

<p>For the rest of this design document, we’ll assume that you’re familiar with 
the basic concepts of the OSB API.</p>

<h2 id="service-catalog-design">Service Catalog Design</h2>

<p><img src="/docs/images/sc-design.svg" alt="Service Catalog Design" /></p>

<p>The above is the high level architecture of Service Catalog.
Service Catalog has two basic building blocks: a Webhook Server and a controller.</p>

<h3 id="webhook-server">Webhook Server</h3>

<p>The Webhook Server uses <a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#what-are-admission-webhooks">Admission Webhooks</a> 
to manage custom resources. Admission Webhook is a feature available in the Kubernetes API Server, 
that allows you to implement arbitrary control decisions, such as validation or mutation.</p>

<p>For every resource managed by Service Catalog (the ones listed in the previous section), there is a separate handler defined. You can see the structure at 
<a href="https://github.com/drycc-addons/service-catalog/blob/master/pkg/webhook/servicecatalog"><code class="highlighter-rouge">pkg/webhook/servicecatalog</code></a>.
The current version of all Service Catalog API resources is <code class="highlighter-rouge">v1beta1</code>. The resources are defined here:
<a href="https://github.com/drycc-addons/service-catalog/blob/master/pkg/apis/servicecatalog/v1beta1/types.go"><code class="highlighter-rouge">pkg/apis/servicecatalog/v1beta1/types.go</code></a>.</p>

<p>If you want to learn more about Admission Webhooks, read <a href="https://kubernetes.io/blog/2019/03/21/a-guide-to-kubernetes-admission-controllers/">this</a> document.</p>

<h3 id="controller">Controller</h3>

<p>The Service Catalog controller implements the behaviors of the service-catalog 
API. It monitors the API resources (by watching the stream of events from the
API server) and takes the appropriate actions to reconcile the current
state with the user’s desired end state.</p>

<p>For example, if a user creates a <code class="highlighter-rouge">ClusterServiceBroker</code>, the Service Catalog 
controller will pick up the event and request the catalog from the 
broker listed in the resource.</p>

<p>For detailed information on a typical workflow, please see 
<a href="/docs/walkthrough/">the walkthrough</a>.</p>


        
           <a href="" onclick="window.open('https://github.com/drycc-addons/service-catalog/issues/new?title=Issue%20with%20' +
           'service-catalog.drycc.cc'+window.location.pathname)" class="button issue">Create an Issue</a>
        
        
          <a href="/editdocs#docs/design.md" class="button issue">Edit this Page</a>
        
    </div>
</section>

<footer col="12">
    <main class="light-text">
        <nav>
            <a href="/docs/walkthrough">Get Started</a>
            <a href="/docs/">Documentation</a>
            <a href="/community">Community</a>
        </nav>
        <div class="social">
            <div>
                <a href="https://github.com/drycc-addons/service-catalog" class="github"><span>Github</span></a>
                <a href="https://kubernetes.slack.com/messages/sig-service-catalog" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-sig-service-catalog" class="mailing-list"><span>Mailing List</span></a>
            </div>
            <div>
                <a href="/docs/install" class="button">Get Service Catalog</a>
                <a href="/docs/devguide" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href="/LICENSE" class="light-text">CC BY 4.0</a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2023 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
.cse .gsc-control-cse, .gsc-control-cse, {
    padding: 0;
}
  .gsc-control-cse table, .gsc-control-cse-en table {
      margin:0px !important;
  }
  .gsc-above-wrapper-area {
      border-bottom: 0;
  }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');

// hide docs nav area if no nav is present, or if nav only contains a link to the current page
/*(function () {
    window.addEventListener('DOMContentLoaded', init)

        // play nice with our neighbors
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                // container is built dynamically, so it may not be present on the first runloop
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();*/
</script>

        <script>

            $(function () {
                'use strict';

                /* selector */
                var postHeader = 'h1,h2,h3,h4';

                $(postHeader).filter('[id]').each(function () {
                    var header      = $(this),
                            headerID    = header.attr('id'),
                            anchorClass = 'header-link',
                            anchorIcon  = '<i class="octicon octicon-link" aria-hidden="true"></i>';

                    if (headerID) {
                        header.prepend($('<a />').addClass(anchorClass).attr({ 'href': '#' + headerID, 'aria-hidden': 'true' }).html(anchorIcon));
                    }

                    return this;
                });
            });


        </script>
<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
    <!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->


</body>
</html>
